---
title: tweak-shell
description: Tweaks system shell settings.
privilege: TrustedInstaller
actions:
  - !writeStatus: { status: 'Tweaking system shell settings.' }

  #=== Start Menu
  # Disable frequently used items list.
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Start'
    value: 'ShowFrequentList'
    type: REG_DWORD
    data: '0'
    weight: 2

  # Disable recently used items list.
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Start'
    value: 'ShowRecentList'
    type: REG_DWORD
    data: '0'
    weight: 2

  #=== This PC
  # Remove default folders.
  - !registryKey:
    path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Desktop\NameSpace_41040327\{e88865ea-0e1c-4e20-9aa6-edcd0212c87c}' # Gallery
    operation: delete
    weight: 2

  - !registryKey:
    path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\MyComputer\NameSpace\{088e3905-0323-4b02-9826-5d99428e115f}' # Local Downloads
    operation: add
    weight: 2

  - !registryKey:
    path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\MyComputer\NameSpace\{1CF1260C-4DD0-4ebb-811F-33C572699FDE}' # My Music
    operation: add
    weight: 2

  - !registryKey:
    path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\MyComputer\NameSpace\{24ad3ad4-a569-4530-98e1-ab02f9417aa8}' # Local Pictures
    operation: add
    weight: 2

  - !registryKey:
    path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\MyComputer\NameSpace\{374DE290-123F-4565-9164-39C4925E467B}' # Downloads
    operation: add
    weight: 2

  - !registryKey:
    path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\MyComputer\NameSpace\{3ADD1653-EB32-4cb0-BBD7-DFA0ABB5ACCA}' # My Pictures
    operation: add
    weight: 2

  - !registryKey:
    path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\MyComputer\NameSpace\{3dfdf296-dbec-4fb4-81d1-6a3438bcf4de}' # Local Music
    operation: add
    weight: 2

  - !registryKey:
    path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\MyComputer\NameSpace\{A0953C92-50DC-43bf-BE83-3742FED03C9C}' # My Videos
    operation: add
    weight: 2

  - !registryKey:
    path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\MyComputer\NameSpace\{A8CDFF1C-4878-43be-B5FD-F8091C1C60D0}' # Documents
    operation: add
    weight: 2

  - !registryKey:
    path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\MyComputer\NameSpace\{B4BFCC3A-DB2C-424C-B029-7FE99A87C641}' # Desktop
    operation: add
    weight: 2

  - !registryKey:
    path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\MyComputer\NameSpace\{d3162b92-9365-467a-956b-92703aca08af}' # Local Documents
    operation: add
    weight: 2

  - !registryKey:
    path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\MyComputer\NameSpace\{f86fa3ab-70d2-4fc7-9c99-fcbf05467f3a}' # Local Videos
    operation: add
    weight: 2

  #=== File Explorer
  # Disable automatic checkboxes activation.
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced'
    value: 'AutoCheckSelect'
    type: REG_DWORD
    data: '0'
    weight: 2

  # Keep original filename case.
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced'
    value: 'DontPrettyPath'
    type: REG_DWORD
    data: '1'
    weight: 2

  #=== Context Menu
  # Remove 'Open with Paint 3D' option for photos.
  - !registryKey:
    path: 'HKLM\SOFTWARE\Classes\SystemFileAssociations\.bmp\Shell\3D Edit'
    operation: add
    weight: 2

  - !registryKey:
    path: 'HKLM\SOFTWARE\Classes\SystemFileAssociations\.jpeg\Shell\3D Edit'
    operation: add
    weight: 2

  - !registryKey:
    path: 'HKLM\SOFTWARE\Classes\SystemFileAssociations\.jpe\Shell\3D Edit'
    operation: add
    weight: 2

  - !registryKey:
    path: 'HKLM\SOFTWARE\Classes\SystemFileAssociations\.jpg\Shell\3D Edit'
    operation: add
    weight: 2

  - !registryKey:
    path: 'HKLM\SOFTWARE\Classes\SystemFileAssociations\.jpg\Shell\3D Edit'
    operation: add
    weight: 2

  - !registryKey:
    path: 'HKLM\SOFTWARE\Classes\SystemFileAssociations\.png\Shell\3D Edit'
    operation: add
    weight: 2

  - !registryKey:
    path: 'HKLM\SOFTWARE\Classes\SystemFileAssociations\.gif\Shell\3D Edit'
    operation: add
    weight: 2

  - !registryKey:
    path: 'HKLM\SOFTWARE\Classes\SystemFileAssociations\.tif\Shell\3D Edit'
    operation: add
    weight: 2

  - !registryKey:
    path: 'HKLM\SOFTWARE\Classes\SystemFileAssociations\.tiff\Shell\3D Edit'
    operation: add
    weight: 2

  #=== File Associations
  # Configure handling for CAB files.
  - !registryKey:
    path: 'HKEY_CLASSES_ROOT\CABFolder\CLSID'
    operation: add
    weight: 2

  - !registryKey:
    path: 'HKEY_CLASSES_ROOT\SystemFileAssociations\.cab\CLSID'
    operation: add
    weight: 2

  # Configure handling for ZIP files.
  - !registryKey:
    path: 'HKEY_CLASSES_ROOT\CompressedFolder\CLSID'
    operation: add
    weight: 2

  - !registryKey:
    path: 'HKEY_CLASSES_ROOT\SystemFileAssociations\.zip\CLSID'
    operation: add
    weight: 2

  # Hide contacts.
  - !registryKey:
    path: 'HKCR\certificate_wab_auto_file'
    operation: add
    weight: 2

  - !registryKey:
    path: 'HKCR\wab_auto_file'
    operation: add
    weight: 2

  - !registryKey:
    path: 'HKCR\contact_wab_auto_file'
    operation: add
    weight: 2

  - !registryKey:
    path: 'HKCR\group_wab_auto_file'
    operation: add
    weight: 2

  - !registryKey:
    path: 'HKCR\vcard_wab_auto_file'
    operation: add
    weight: 2

  - !registryKey:
    path: 'HKCR\WAB.AssocProtocol.LDAP'
    operation: add
    weight: 2

  - !registryKey:
    path: 'HKCR\TIFImage.Document'
    operation: add
    weight: 2

  - !registryKey:
    path: 'HKCR\PhotoViewer.FileAssoc.Tiff'
    operation: add
    weight: 2

  #=== Taskbar
  # Hide chat button.
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced'
    value: 'TaskbarMn'
    type: REG_DWORD
    data: '0'
    weight: 2

  # Hide meet now button.
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\Explorer'
    value: 'HideSCAMeetNow'
    type: REG_DWORD
    data: '1'
    weight: 2

  # Hide tasks view button.
  - !registryValue:
    path: 'HKU\S-1-5-18\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced'
    value: 'ShowTaskViewButton'
    type: REG_DWORD
    data: '0'
    weight: 2

  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced'
    value: 'ShowTaskViewButton'
    type: REG_DWORD
    data: '0'
    weight: 2

  # Hide search box.
  - !registryValue:
    path: 'HKU\S-1-5-18\SOFTWARE\Microsoft\Windows\CurrentVersion\Search'
    value: 'SearchboxTaskbarMode'
    type: REG_DWORD
    data: '0'
    weight: 2

  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Search'
    value: 'SearchboxTaskbarMode'
    type: REG_DWORD
    data: '0'
    weight: 2

  # Hide Cortana button.
  - !registryValue:
    path: 'HKU\S-1-5-18\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced'
    value: 'ShowCortanaButton'
    type: REG_DWORD
    data: '0'
    weight: 2

  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced'
    value: 'ShowCortanaButton'
    type: REG_DWORD
    data: '0'
    weight: 2

  # Enable end task by right click.
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced\TaskbarDeveloperSettings'
    value: 'TaskbarEndTask'
    type: REG_DWORD
    data: '0'
    weight: 2

  #=== Tray
  # Auto hide tray icons.
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer'
    value: 'EnableAutoTray'
    type: REG_DWORD
    data: '0'
    weight: 2

  #=== Search
  # Enable full disks indexing.
  - !registryValue:
    path: 'HKLM\SOFTWARE\Microsoft\Windows Search\Gather\Windows\SystemIndex'
    value: 'EnableFindMyFiles'
    type: REG_DWORD
    data: '1'
    weight: 2

  # Disable Cortana.
  - !registryValue:
    path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\Windows Search'
    value: 'AllowCortana'
    type: REG_DWORD
    data: '0'
    weight: 2

  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Search'
    value: 'CortanaConsent'
    type: REG_DWORD
    data: '0'
    weight: 2

  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Search'
    value: 'CortanaInAmbientMode'
    type: REG_DWORD
    data: '0'
    weight: 2

  - !registryValue:
    path: 'HKLM\SOFTWARE\Microsoft\Speech_OneCore\Preferences'
    value: 'VoiceActivationEnableAboveLockscreen'
    type: REG_DWORD
    data: '0'
    weight: 2

  # Disable voice search.
  - !registryValue:
    path: 'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\OOBE'
    value: 'DisableVoice'
    type: REG_DWORD
    data: '1'
    weight: 2

  - !registryValue:
    path: 'HKLM\SOFTWARE\Microsoft\Speech_OneCore\Preferences'
    value: 'VoiceActivationDefaultOn'
    type: REG_DWORD
    data: '0'
    weight: 2

  - !registryValue:
    path: 'HKLM\SOFTWARE\Microsoft\Speech_OneCore\Preferences'
    value: 'ModelDownloadAllowed'
    type: REG_DWORD
    data: '0'
    weight: 2

  # Disable web search.
  - !registryValue:
    path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\Windows Search'
    value: 'AllowCloudSearch'
    type: REG_DWORD
    data: '0'
    weight: 2

  - !registryValue:
    path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\Windows Search'
    value: 'DisableWebSearch'
    type: REG_DWORD
    data: '1'
    weight: 2

  - !registryValue:
    path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\Windows Search'
    value: 'ConnectedSearchUseWeb'
    type: REG_DWORD
    data: '0'
    weight: 2

  - !registryValue:
    path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\Windows Search'
    value: 'ConnectedSearchUseWeb'
    type: REG_DWORD
    data: '0'
    weight: 2

  - !registryValue:
    path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\Windows Search'
    value: 'ConnectedSearchUseWebOverMeteredConnections'
    type: REG_DWORD
    data: '0'
    weight: 2

  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Search'
    value: 'BingSearchEnabled'
    type: REG_DWORD
    data: '0'
    weight: 2

  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\SearchSettings'
    value: 'SafeSearchMode'
    type: REG_DWORD
    data: '0'
    weight: 2

  # Disable search history.
  - !registryValue:
    path: 'HKCU\SOFTWARE\Policies\Microsoft\Windows\Explorer'
    value: 'DisableSearchBoxSuggestions'
    type: REG_DWORD
    data: '1'
    weight: 2

  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Search'
    value: 'HistoryViewEnabled'
    type: REG_DWORD
    data: '0'
    weight: 2

  # Disable system language detection.
  - !registryValue:
    path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\Windows Search'
    value: 'AlwaysUseAutoLangDetection'
    type: REG_DWORD
    data: '0'
    weight: 2

  # Disable location detection.
  - !registryValue:
    path: 'HKLM\SOFTWARE\Policies\Microsoft\Windows\Windows Search'
    value: 'AllowSearchToUseLocation'
    type: REG_DWORD
    data: '0'
    weight: 2

  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Search'
    value: 'AllowSearchToUseLocation'
    type: REG_DWORD
    data: '0'
    weight: 2

  # Disable data collection.
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\InputPersonalization'
    value: 'RestrictImplicitTextCollection'
    type: REG_DWORD
    data: '1'
    weight: 2

  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\InputPersonalization'
    value: 'RestrictImplicitInkCollection'
    type: REG_DWORD
    data: '1'
    weight: 2

  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\InputPersonalization\TrainedDataStore'
    value: 'AcceptedPrivacyPolicy'
    type: REG_DWORD
    data: '0'
    weight: 2

  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Personalization\Settings'
    value: 'AcceptedPrivacyPolicy'
    type: REG_DWORD
    data: '0'
    weight: 2

  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\InputPersonalization\TrainedDataStore'
    value: 'HarvestContacts'
    type: REG_DWORD
    data: '0'
    weight: 2

  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\AppHost'
    value: 'EnableWebContentEvaluation'
    type: REG_DWORD
    data: '0'
    weight: 2

  - !registryValue:
    path: 'HKCU\Control Panel\International\User Profile'
    value: 'HttpAcceptLanguageOptOut'
    type: REG_DWORD
    data: '1'
    weight: 2

  #=== Notifications
  # Disable installed on unsupported hardware alerts.
  - !registryValue:
    path: 'HKCU\Control Panel\UnsupportedHardwareNotificationCache'
    value: 'SV1'
    type: REG_DWORD
    data: '0'
    weight: 2

  - !registryValue:
    path: 'HKCU\Control Panel\UnsupportedHardwareNotificationCache'
    value: 'SV2'
    type: REG_DWORD
    data: '0'
    weight: 2

  # Disabling setup Windows backup reminders.
  - !registryValue:
    path: 'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Notifications\Settings\Windows.SystemToast.BackupReminder'
    value: 'Enabled'
    type: REG_DWORD
    data: '0'
    weight: 2
