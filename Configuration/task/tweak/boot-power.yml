---
title: tweak-boot-power
description: Tweaks boot and power settings.
privilege: TrustedInstaller
actions:
  - !writeStatus: { status: 'Tweaking boot and power settings.' }

  # Enable legacy boot menu for advanced startup options.
  - !cmd:
    command: 'bcdedit /set {default} bootmenupolicy legacy'
    weight: 2

  # Disable hibernation to ensure NTFS drives are accessible.
  - !cmd:
    command: 'powercfg /hibernate off'
    weight: 2

  # Reduce shutdown time by lowering services and programs timeout.
  - !registryValue:
    path: 'HKCU\Control Panel\Desktop'
    value: 'WaitToKillAppTimeOut'
    type: REG_SZ
    data: '2000'
    weight: 2

  - !registryValue:
    path: 'HKLM\SYSTEM\CurrentControlSet\Control'
    value: 'WaitToKillServiceTimeout'
    type: REG_SZ
    data: '2000'
    weight: 2

  - !registryValue:
    path: 'HKLM\SYSTEM\CurrentControlSet\Control'
    value: 'HungAppTimeout'
    type: REG_SZ
    data: '2000'
    weight: 2

  - !registryValue:
    path: 'HKLM\SYSTEM\CurrentControlSet\Control'
    value: 'AutoEndTasks'
    type: REG_SZ
    data: '1'
    weight: 2
